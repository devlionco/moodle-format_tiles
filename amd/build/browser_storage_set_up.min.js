define(["jquery"],function(a){"use strict";var b,c={GIVEN:"yes",DENIED:"no"},d={userPrefStorage:"mdl-tiles-userPrefStorage",user:"-user-"},e={local:"local",session:"session"},f={local:!1,session:!1},g=null,h=function(){return d.userPrefStorage+d.user+b},i=function(){if(null!==g)return g;var a=localStorage.getItem(h());return a?g=a===c.GIVEN:null},j=function(a){a?(g=!0,localStorage.setItem(h(),c.GIVEN)):(g=!1,localStorage.setItem(h(),c.DENIED))},k=function(a){require(["core/str","core/notification"],function(b,c){b.get_strings([{key:"datapref",component:"format_tiles"},{key:"dataprefquestion",component:"format_tiles"},{key:"yes"},{key:"no"}]).done(function(b){c.confirm(b[0],b[1],b[2],b[3],function(){j(!0)},function(){j(!1),"function"==typeof a&&a()})})})},l=function(a){var b;try{return a===e.local?b=localStorage:a===e.session&&(b=sessionStorage),"undefined"!=typeof b&&(b.setItem("testItem","testValue"),"testValue"===b.getItem("testItem")&&(b.removeItem("testItem"),!0))}catch(c){return require(["core/log"],function(a){a.debug(c)}),!1}};return{setAllowed:function(a){j(a)},storageAllowed:function(){return i()},getStorageKey:function(){return h()},Enabled:f,init:function(c,d,h){b=c,a(document).ready(function(){f.local=l(e.local),f.session=l(e.session),d?g=!0:null===i()&&f.local,a('a[href*="datapref"]').click(function(a){a.preventDefault(),k(h)})})}}});